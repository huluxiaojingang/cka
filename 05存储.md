# Storage 7%
- Understand persistent volumes and know how to create them
- Understand acces modes for volumes
- Understand persistent volume claims primitive
- Understand Kubernetes storage objects
- Know how to configure applications with persistent storage

# Volume

  普通存储卷，没有资源对象，与Pod生命周期一起
```
├── 容器启动时依赖
    ├── secret
    ├── configmap
├── 临时数据存储
    ├── emptyDir
    ├── hostPath
├── 持久化数据存储
    ├── nfs
    ├── cephfs
    ├── GlusterFS
    ├── Cloud
    ├── ...
```

```
apiVersion: v1
kind: Pod
metadata:
  name: test-pod
spec:
  containers:
  - name: test-container
    image: xxx
    volumeMounts:
    - mountPath: /test-pd
      name: test-volume
  volumes:
  - name: test-volume
    hostPath:
      path: /data
```

# PersistentVolume
  存储系统与应用系统区分开，单独资源对象，它不直接和Pod发生关系，通过另一个资源对象PersistentVolumeClaim来绑定关联
  pv状态：Avaliable,Bound,Released,Failed
  pv与pvc匹配
  
  ```
  ├── capacity.storage 容量
  ├── accessModes
      ├── ReadWriteOnce = RWO
      ├──
      ├──
  ├── storageClassName
  ```



## 静态模式创建PV
  手动创建PV资源，用起来不太方便，也会造成资源浪费。


## 动态模式创建PV
  只创建PVC，系统根据PVC自动创建PV。k8s安装后配置StorageClass，规定集群支持哪些存储驱动，当然后面也可以修改。
  
  
```
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mongodb-pvc-claim
spec:
  resources:
    requests:
      # 存储大小
      storage: 1Gi
  # 存储访问模式，依赖存储厂商的能力
  accessModes:
    - ReadWriteOnce
  # 存储类型，适配不同场景
  storageClassName: sata
```

存储内容很少，一个是普通存储volume，另一个是PV/PVC

### ConfigMap

从配置文件创建ConfigMap对象
game.properties
```
enemies=aliens
lives=3
enemies.cheat=true
enemies.cheat.level=noGoodRotten
secret.code.passphrase=UUDDLRLRBABAS
secret.code.allowed=true
```

```
kubectl create configmap game-config --from-file=game.properties
```

将configmap导入到Pod的环境变量








